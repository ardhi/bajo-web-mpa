{% set sorts = _meta.reqQuery.sort|d('')|split(':') %}
{% set sortDir = (sorts[1] === '1')|ternary('-1', '1')%}
{% cmp 'table', responsive=true %}
  {% cmp 'tableHead' %}
    {% cmp 'tableRow' %}
      {% for p in attr.schema.properties %}
        {% cmp 'tableHeader', text='nowrap' %}
          {% if p.index or p.name === 'id' %}
            {% set params = _meta.reqQuery|pick(['query'])|set('sort', p.name + ':' + (sorts[0] === p.name)|ternary(sortDir|d(''), '1')) %}
            {% cmp 'a', href='?' + params|qsStringify %}
              {{- ('field.' + p.name)|t -}}
            {% endcmp %}
            {% if p.name === sorts[0] %}
              {% cmp 'icon', name=(sortDir === '-1')|ternary('caretUp', 'caretDown') %}{% endcmp %}
            {% endif %}
          {% else %}
            {{ ('field.' + p.name)|t }}
          {% endif %}
        {% endcmp %}
      {% endfor %}
    {% endcmp %}
  {% endcmp %}
  {% cmp 'tableBody', table='groupDivider' %}
    {% for r in attr.records %}
      {% cmp 'tableRow' %}
        {% for p in attr.schema.properties %}
          {% cmp 'tableDataCell' %}{{ r[p.name] }}{% endcmp %}
        {% endfor %}
      {% endcmp %}
    {% endfor %}
  {% endcmp %}
{% endcmp %}
